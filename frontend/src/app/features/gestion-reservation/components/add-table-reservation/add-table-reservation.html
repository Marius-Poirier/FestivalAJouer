<div class="modal-overlay" (click)="close.emit()">
	<div class="modal-card" (click)="$event.stopPropagation()">
		<div class="modal-header">
			<h2>Ajouter une table à la réservation</h2>
			<button class="btn-close" type="button" (click)="close.emit()">✕</button>
		</div>

		<div class="modal-body">
			@if (!reservationId()) {
				<div class="error-banner">Identifiant de réservation manquant</div>
			} @else {
				<div class="form-grid">
					<mat-form-field appearance="outline" class="full">
						<mat-label>Zone du plan</mat-label>
						<mat-select (selectionChange)="onSelectZonePlan($event.value)">
							@for (zone of zonesDuPlan(); track zone.id) {
								<mat-option [value]="zone.id">
									{{ zone.nom }}
								</mat-option>
							}
						</mat-select>
					</mat-form-field>

					<mat-form-field appearance="outline" class="full">
						<mat-label>Table disponible</mat-label>
						<mat-select (selectionChange)="onSelectTable($event.value)">
							@if (availableTables().length === 0) {
								<mat-option disabled>Aucune table libre pour cette zone</mat-option>
							} @else {
								@for (t of availableTables(); track t.id) {
									<mat-option [value]="t.id">
										Table #{{ t.id }} · Capacité jeux: {{ t.capacite_jeux }}
									</mat-option>
								}
							}
						</mat-select>
					</mat-form-field>
				</div>
			}
		</div>

		<div class="modal-footer">
			<button type="button" class="btn secondary" (click)="close.emit()">Annuler</button>
			<button type="button" class="btn" (click)="onSubmitAdd()">Ajouter</button>
		</div>
	</div>
</div>
