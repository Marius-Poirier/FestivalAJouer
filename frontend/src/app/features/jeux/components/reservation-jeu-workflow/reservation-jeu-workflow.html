<div class="container">

  @if (!currentFestival()?.id) {
    <p>Sélectionne un festival pour voir les jeux.</p>
  } @else if (isLoading()) {
    <p>Chargement...</p>
  } @else if (error()) {
    <p class="error">{{ error() }}</p>
  } @else {

    <!-- BARRE DE RECHERCHE -->
    <div class="header-controls">
      <div class="search-bar">
        <mat-icon class="search-icon">search</mat-icon>
        <input
          type="text"
          placeholder="Rechercher un jeu..."
          [value]="searchTerm()"
          (input)="onSearch($event)"
        />
      </div>

      <div class="count">
        {{ filteredJeux().length }} / {{ jeux().length }}
      </div>
    </div>

    @if (jeux().length === 0) {
      <p>Aucun jeu ajouté via les réservations.</p>
    } @else {
      @if (filteredJeux().length === 0) {
        <p>Aucun jeu ne correspond à la recherche.</p>
      } @else {
        <ul class="grid">
          @for (j of filteredJeux(); track j.id) {
            <li>
              <app-jeu-card
                [jeu]="j"
                [canManage]="true"
                (detail)="onDetail($event)"
                (update)="onUpdate($event)"
                (delete)="onDelete($event)">
              </app-jeu-card>
            </li>
          }
        </ul>
      }
    }

    <!-- MODALE EDIT -->
    @if (showForm()) {
      <app-jeu-form
        [jeu]="editingJeu()"
        [mode]="editingJeu() ? 'edit' : 'create'"
        (closeForm)="onFormClosed()">
      </app-jeu-form>
    }
  }
</div>
