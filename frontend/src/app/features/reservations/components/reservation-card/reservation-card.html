<!-- reservation-card.html -->
@if(reservation()){
    @let res = reservation()!;
    @let edi = editeur();
    
    <mat-card class="card-container" (click)="navigateToDetail(res.id!)">
        @if (canManage()) {
            <button
                class="delete-btn"
                (click)="openDeletePopup(res); $event.stopPropagation()"
                aria-label="Supprimer"
            >
                <mat-icon>close</mat-icon>
            </button>
        }

        <mat-card-header class="header-row">
            <!-- Logo de l'éditeur -->
            <div class="logo-wrap" (click)="$event.stopPropagation()">
                @if (edi?.logo_url) {
                    <img
                        class="editeur-logo"
                        [src]="edi.logo_url"
                        [alt]="edi.nom"
                        loading="lazy"
                    />
                } @else {
                    <div class="editeur-logo placeholder" aria-hidden="true">
                        {{ (edi?.nom?.[0] ?? '?') | uppercase }}
                    </div>
                }
            </div>

            <!-- Informations de la réservation -->
            <div class="header-text">
                <div class="subtitle">Réservation #{{ res.id ?? '—' }}</div>
                <h2 class="title">{{ edi?.nom ?? 'Éditeur inconnu' }}</h2>
                <div class="meta-info">
                    <span class="badge">{{ res.statut_workflow }}</span>
                </div>
            </div>
        </mat-card-header>
    </mat-card>
    
    <!-- Popup delete -->
    <app-popup-delete
        [entiteType]="deleteType()"
        [entiteId]="deleteId()"
        [entitenom]="deletenom()"
        (confirm)="handleConfirm()"
        (cancel)="handleCancel()">
    </app-popup-delete>
}