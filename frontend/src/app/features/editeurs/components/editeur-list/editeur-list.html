<div class="list-container">
  @if (editeurService.error()) {
    <div class="error-banner">
      {{ editeurService.error() }}
    </div>
  }

  <div class="header-controls">
    <div class="search-bar">
      <mat-icon class="search-icon">search</mat-icon>
      <input
        type="text"
        placeholder="Rechercher un éditeur..."
        [value]="searchTerm()"
        (input)="onSearch($event)"
      />
    </div>

    @if (authService.isAdminSuperorgaOrga()) {
      <button class="btn-add" (click)="openCreateForm()">
        + Ajouter un éditeur
      </button>
    }
  </div>

  @if (editeurService.isLoading() && !editeurService.editeurs().length) {
    <p class="loading">Chargement des éditeurs...</p>
  } @else {
    @if (!filteredEditeurs().length) {
      <p class="no-results">Aucun éditeur trouvé.</p>
    } @else {
      <ul class="editeurs-list">
        @for (edi of paginatedEditeurs(); track edi.id) {
          <li>
            <app-editeur-card
              [editeur]="edi"
              [canManage]="authService.isAdminSuperorga()"
              (delete)="onDelete($event)"
              (update)="onUpdate($event)"
              (detail)="onDetail($event)">
            </app-editeur-card>
          </li>
        }
      </ul>

      @if (totalPages() > 1) {
        <div class="pagination">
          <button
            class="page-btn"
            type="button"
            [disabled]="currentPage() === 1"
            (click)="goToPreviousPage()">
            ← Précédent
          </button>

          <span class="page-info">
            Page {{ currentPage() }} / {{ totalPages() }}
          </span>

          <button
            class="page-btn"
            type="button"
            [disabled]="currentPage() === totalPages()"
            (click)="goToNextPage()">
            Suivant →
          </button>
        </div>
      }
    }
  }

  @if (showForm()) {
    <app-editeur-form
      [editeur]="editingEditeur()"
      (closeForm)="closeForm()">
    </app-editeur-form>
  }
</div>
