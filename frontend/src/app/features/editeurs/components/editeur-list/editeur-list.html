<div class="list-container">
  @if (editeurService.error()) {
    <div class="error-banner">
      {{ editeurService.error() }}
    </div>
  }

  <div class="header-controls">
    <div class="search-bar">
      <mat-icon class="search-icon">search</mat-icon>
      <input
        type="text"
        placeholder="Rechercher un éditeur..."
        [value]="searchTerm()"
        (input)="onSearch($event)"
      />
    </div>

    @if (authService.isAdminSuperorgaOrga()) {
      <button class="btn-add" (click)="toggleForm()">+ Ajouter un éditeur</button>
    }
  </div>

  @if (editeurService.isLoading() && !editeurService.editeurs().length) {
    <p class="loading">Chargement des éditeurs...</p>
  } @else {
    <ul class="editeurs-list">
      @for (edi of paginatedEditeurs(); track edi.id) {
        <li>
          <app-editeur-card
            [editeur]="edi"
            [canManage]="authService.isAdminSuperorgaOrga()"
            (delete)="onDelete($event)"
            (update)="onUpdate($event)"
            (detail)="onDetail($event)">
          </app-editeur-card>
        </li>
      }
    </ul>

    @if (filteredEditeurs().length > 0 && totalPages() > 1) {
      <div class="pagination">
        <button
          type="button"
          (click)="prevPage()"
          [disabled]="currentPage() === 1">
          ← Précédent
        </button>

        <span>Page {{ currentPage() }} / {{ totalPages() }}</span>

        <button
          type="button"
          (click)="nextPage()"
          [disabled]="currentPage() === totalPages()">
          Suivant →
        </button>
      </div>
    }
  }

  @if (showForm()) {
    <app-editeur-form (closeForm)="toggleForm()"></app-editeur-form>
  }
</div>
